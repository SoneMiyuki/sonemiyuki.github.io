<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  	<meta property="og:title" content=" Posts &middot;  世界的中心" />
  	<meta property="og:site_name" content="世界的中心" />
  	<meta property="og:url" content="https://sonemiyuki.cn/post/" />
    
    
    <meta property="og:type" content="website" />
    

  <title>
     Posts &middot;  世界的中心
  </title>

    <meta name="description" content="教学楼的天台，是世界的中心。" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://sonemiyuki.cn/images/favicon.ico">
	  <link rel="apple-touch-icon" href="https://sonemiyuki.cn/images/apple-touch-icon.png" />
    
    <link rel="stylesheet" type="text/css" href="https://sonemiyuki.cn/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="https://sonemiyuki.cn/index.xml" rel="alternate" type="application/rss+xml" title="世界的中心" />
      
      
        <link href="https://sonemiyuki.cn/post/index.xml" rel="alternate" type="application/rss+xml" title="Posts &middot; 世界的中心" />
      
    
    <meta name="generator" content="Hugo 0.83.0" />

    <link rel="canonical" href="https://sonemiyuki.cn/post/" />

     
</head>
<body class="nav-closed">
<div id="particles-js"></div>
  


 <div class="site-wrapper">




	<header class="main-header" style="background-image: url(https://sonemiyuki.cn/images/user.jpg)">

    <nav class="main-nav overlay clearfix">
      
        <a class="blog-logo" href="https://sonemiyuki.cn/"><img src="https://sonemiyuki.cn/images/user.png" alt="Home" /></a>
      
      
        
          <a class="menu-button icon-feed" href="https://sonemiyuki.cn/post/index.xml">&nbsp;&nbsp;Subscribe</a>
        
      
    </nav>
    <div class="vertical">

        <div class="main-header-content inner">
            <h1 class="page-title">

              <a class="btn-bootstrap-2" href="#content">世界的中心</a>
          </h1>
        </div>
</div>
    <a class="scroll-down icon-arrow-left" href="#content"><span class="hidden">Scroll Down</span></a>
</header>

<main id="content" class="content" role="main">
    
    
    
    

	<div class="extra-pagination inner">
    <nav class="pagination" role="navigation">
	
	    <a class="newer-posts" href="https://sonemiyuki.cn/post/page/2/">&larr; Newer Posts</a>
	
	<span class="page-number">Page 3 of 3</span>
	
</nav>

	</div>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="https://sonemiyuki.cn/post/2021/05/09/get-post/">操作系统(1)</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
          <section class="post-content">
            <h2 id="1-操作系统概述">1. 操作系统概述</h2>
<ul>
<li>执行指令：Fetch -&gt; Execute</li>
</ul>
<p>四种中断：</p>
<ul>
<li>程序中断：由程序执行结果产生（溢出，除以零，非法机器指令，访问不合法/无权限内存）</li>
<li>时钟中断：处理器内部的计时器产生，允许操作系统以一定的规则执行函数</li>
<li>IO中断：由IO控制器产生，用于发信号通知操作是否正常完成及其错无条件</li>
<li>硬件失效中断：硬件故障产生的中断</li>
</ul>
<p>IO中断</p>
<ul>
<li>无中断：在写的时候直接写</li>
<li>短IO等待时间：处理器和IO并行，用中断处理器进程的方式处理IO的结束</li>
<li>长IO等待时间：等到下一个进程开始的时候对上一个进程的IO收尾，开始下一个IO的准备</li>
</ul>
<p>中断执行</p>
<ul>
<li>本质上是栈的思想和应用
<ul>
<li>设备控制器或者其他系统硬件产生一个中断</li>
<li>处理器结束指令执行</li>
<li>处理器发送中断应答信号</li>
<li>PSW，PC入栈</li>
<li>根据中断加载新的PC值</li>
<li>保存剩余的处理状态信息</li>
<li>处理终端</li>
<li>恢复状态信息</li>
<li>恢复PSW，PC</li>
</ul>
</li>
</ul>
<p>多中断</p>
<ul>
<li>嵌套中断（优先级）</li>
<li>顺序中断（默认）</li>
</ul>
<p>存储器的三大要素两两关系</p>
<ul>
<li>存储时间</li>
<li>位价格</li>
<li>总容量</li>
</ul>
<p>速度降低，时间变高，价格降低，容量变大</p>
<ul>
<li>寄存器</li>
<li>Cache</li>
<li>内存</li>
<li>磁盘</li>
<li>磁带</li>
</ul>
<p>设计Cache需要考虑的因素</p>
<ul>
<li>存储器大小</li>
<li>块的大小</li>
<li>mapping函数</li>
<li>替换算法</li>
<li>写策略</li>
<li>缓存级数</li>
</ul>
<p>DMA</p>
<ul>
<li>可编程IO操作：需要程序员监控检查，耗费资源</li>
<li>中断驱动IO操作：IO准备好之后会对处理器进行中断，每个字都要通过处理器</li>
<li>DMA操作：DMA模块直接和存储器操作，传输整个数据块，传输完成产生中断
<ul>
<li>停止访存、周期挪用、交替访存</li>
</ul>
</li>
</ul>
<p>习题：</p>
<ul>
<li>多终端的处理方式是什么？</li>
<li>什么是Cache？</li>
<li>多处理器和多核系统的区别？</li>
<li>时间局部性、空间局部性</li>
</ul>
<h2 id="进程描述和控制">进程描述和控制</h2>
<p>什么是进程？</p>
<ul>
<li>一个正在执行的程序</li>
<li>计算机中正在运行的程序的一个实例</li>
<li>一个具有如下要素的活动单元：一组指令序列的执行、一个当前状态、一组相关的系统资源的集合</li>
<li>代码、数据、PCB</li>
</ul>
<p>进程的属性与PCB的内容</p>
<ul>
<li>ID</li>
<li>状态</li>
<li>优先级</li>
<li>程序计数器</li>
<li>内存指针</li>
<li>上下文数据</li>
<li>IO状态信息</li>
<li>审计信息</li>
</ul>
<p>进程状态</p>
<ul>
<li>二状态模型</li>
<li>五状态模型</li>
<li>七状态模型</li>
</ul>
<p>进程创建的原因：</p>
<ul>
<li>新的批处理作业</li>
<li>用户登录</li>
<li>OS服务</li>
<li>派生进程</li>
</ul>
<p>进程终止的原因：</p>
<ul>
<li>正常完成</li>
<li>算术错误</li>
<li>数据误用</li>
<li>超过时限</li>
<li>时间超出</li>
<li>OS干预</li>
<li>内存不足</li>
<li>IO失败</li>
<li>父进程终止</li>
<li>父进程请求</li>
<li>越界</li>
<li>无效指令</li>
<li>保护错误</li>
<li>特权指令</li>
</ul>
<p>进程五状态图
<img src="https://sonemiyuki.cn/images/os/5statemodel.png" alt="进程五状态图"></p>
<p>为什么要把进程挂起</p>
<ul>
<li>在没有虚拟内存的情况下，进程必须载入内存才能运行</li>
<li>所有进程等待IO的时候处理器空闲</li>
<li>交换一些进程到磁盘以释放内存</li>
<li>阻塞变成挂起</li>
</ul>
<p>挂起进程的特点：</p>
<ul>
<li>被封印在磁盘中，不能立即执行</li>
<li>为了阻止进程执行可以将其挂起</li>
<li>必须由代理显式命令系统对其状态转换</li>
</ul>
<p>进程挂起的原因</p>
<ul>
<li>交换</li>
<li>其他OS原因</li>
<li>用户请求</li>
<li>定时进程</li>
<li>父进程请求</li>
</ul>
<p>OS是什么</p>
<p>OS本质上是管理系统资源的实体</p>
<ul>
<li>控制计算机系统的内部事件</li>
<li>为处理器执行任务进行调度和分配</li>
<li>给进程分配资源</li>
<li>响应用户程序的服务请求</li>
</ul>
<p>OS维护的信息</p>
<ul>
<li>内存表</li>
<li>IO表</li>
<li>文件表</li>
<li>进程表</li>
</ul>
<p>内存表：跟踪主存和辅存</p>
<ul>
<li>分配给进程的主存</li>
<li>分配给进程的辅存</li>
<li>主存或者虚存的保护属性</li>
<li>管理虚存需要的信息</li>
</ul>
<p>IO表：管理计算机设备的IO设备和通道</p>
<ul>
<li>IO设备的状态</li>
<li>IO操作的状态</li>
<li>IO传送的源地址和目的地址</li>
</ul>
<p>文件表：</p>
<ul>
<li>文件的存在性</li>
<li>文件在辅存中的位置</li>
<li>文件的当前状态</li>
<li>文件的属性</li>
<li>大部分信息由文件管理系统维护和使用</li>
</ul>
<p>进程表：OS用于控制和管理进程的表</p>
<ul>
<li>进程加载的位置</li>
<li>进程映像
<ul>
<li>用户程序</li>
<li>用户数据
<ul>
<li>程序数据</li>
<li>用户栈</li>
<li>可修改的程序</li>
</ul>
</li>
<li>系统栈</li>
<li>PCB</li>
</ul>
</li>
</ul>
<p>PCB本质上是进程属性的集合</p>
<ul>
<li>进程标识
<ul>
<li>ID号</li>
</ul>
</li>
<li>处理器状态信息
<ul>
<li>用户可见存储器</li>
<li>控制状态寄存器
<ul>
<li>PC</li>
<li>PSW</li>
</ul>
</li>
<li>栈指针
<ul>
<li>LIFO系统栈</li>
</ul>
</li>
</ul>
</li>
<li>进程控制信息
<ul>
<li>调度和状态信息
<ul>
<li>进程状态</li>
<li>优先级</li>
<li>调度信息</li>
<li>事件</li>
</ul>
</li>
<li>数据结构</li>
<li>进程间通信信息</li>
<li>进程特权
<ul>
<li>被赋予的特权</li>
<li>系统实用程序和服务使用</li>
</ul>
</li>
<li>存储管理</li>
<li>资源所有权和使用情况</li>
</ul>
</li>
</ul>
<p>PCB的作用</p>
<ul>
<li>进程调度</li>
<li>资源分配</li>
<li>中断处理</li>
<li>性能监控和分析</li>
</ul>
<p>访问PCB的方法</p>
<p>用ID访问</p>
<p>困难在于对PCB的保护，因此出现了处理例程对PCB进行仲裁与保护。</p>
<p>执行模式：</p>
<ul>
<li>用户模式</li>
<li>内核模式</li>
</ul>
<p>模式切换：PSW</p>
<p>进程创建：</p>
<ul>
<li>分配ID</li>
<li>分配空间</li>
<li>初始化PCB</li>
<li>设置连接</li>
<li>创建数据结构如审计文件</li>
</ul>
<p>进程切换时机：</p>
<ul>
<li>时钟中断
<ul>
<li>时间片</li>
</ul>
</li>
<li>IO中断
<ul>
<li>等IO</li>
<li>优先级抢占</li>
</ul>
</li>
<li>内存错误
<ul>
<li>虚存不在主存中</li>
<li>调入内存的IO请求</li>
<li>进程切换</li>
</ul>
</li>
<li>陷阱
<ul>
<li>一个错误或者异常</li>
<li>进程退出切换到别的进程执行</li>
</ul>
</li>
<li>系统调用
<ul>
<li>进程对OS发出系统调用服务</li>
</ul>
</li>
</ul>
<p>进程切换步骤：</p>
<ul>
<li>保存处理器上下文
<ul>
<li>PC和其他寄存器</li>
</ul>
</li>
<li>更新当前运行态的PCB
<ul>
<li>修改状态</li>
</ul>
</li>
<li>PCB移到相应队列</li>
<li>选择另一个进程执行</li>
<li>更新PCB，进程状态改成运行态</li>
<li>更新内存管理的数据结构</li>
<li>恢复处理器的上下文</li>
</ul>
<p>内核功能：</p>
<ul>
<li>进程管理
<ul>
<li>进程创建和终止</li>
<li>进程调度和委派</li>
<li>进程切换</li>
<li>进程同步和通信支持</li>
<li>管理PCB</li>
</ul>
</li>
<li>内存管理
<ul>
<li>为进程分配地址</li>
<li>交换</li>
<li>页管理和段管理</li>
</ul>
</li>
<li>IO管理
<ul>
<li>Buffer管理</li>
<li>为进程分配IO通道和设备</li>
</ul>
</li>
<li>支持功能
<ul>
<li>中断</li>
<li>记账</li>
<li>监视</li>
</ul>
</li>
</ul>
<p>OS的执行</p>
<ul>
<li>无进程内核
<ul>
<li>在所有的进程之外执行OS内核</li>
<li>OS代码在特权状态下工作的独立实体被实行</li>
<li>进程的概念仅适用于用户程序</li>
</ul>
</li>
<li>在用户进程中执行
<ul>
<li>OS软件在用户进程中</li>
<li>代码和数据是共享的</li>
<li>执行OS代码切换到内核模式</li>
<li>只进行进程内模式切换</li>
<li>在这基础上，用户无法篡改OS例程</li>
</ul>
</li>
<li>基于进程的OS
<ul>
<li>把OS当做一组系统进程实现</li>
<li>多处理器或者多机系统</li>
</ul>
</li>
</ul>
<p>UNIX进程状态</p>
<p><img src="https://sonemiyuki.cn/images/os/unixstatemodel.png" alt="UNIX进程状态"></p>
<p>习题：</p>
<p>为什么需要用户模式和内核模式？
操作系统新建进程的步骤是什么？
画出七状态模型的模型图并且解释状态变化的原因。</p>
<p>参考书籍：
操作系统————精髓与设计原理（第八版） William Stallings</p>

          </section>
      </p>
      
    </section>
    <footer class="post-meta">
        
            <img class="author-thumb" src="https://sonemiyuki.cn/images/user.png" alt="Author image" nopin="nopin" />
        
        
            miyuki
        
        on
            
                <a href="https://sonemiyuki.cn/tags/os/">#os</a>,
            
        
        <time class="post-date" datetime="2021-05-09T22:29:30&#43;08:00">
            9 May 2021
        </time>
    </footer>
</article>

	
	   
<article class="post post">
    <header class="post-header">
        <h2 class="post-title"><a href="https://sonemiyuki.cn/post/2021/05/06/py3unittest/">Python 3单元测试unittest及HTML报告生成速成</a></h2>
    </header>
    <section class="post-excerpt">
      <p>
          <section class="post-content">
            <h4 id="python3单元测试unittest及html报告生成速成">Python3单元测试unittest及HTML报告生成速成</h4>
<p>前置知识：</p>
<ul>
<li>Python面向对象基本</li>
<li>单元测试基本知识</li>
<li>Junit等其他测试框架关于测试类、测试方法、测试套件等基本构件的知识</li>
</ul>
<p>我们先定义一个待测试的类和对象
code.py</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">algor</span>:
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">add</span>(a, b):
        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b
</code></pre></div><p>然后开一个测试文件</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3"><span style="color:#f92672">from</span> code <span style="color:#66d9ef">import</span> algor
<span style="color:#f92672">import</span> unittest

<span style="color:#75715e"># 下述文件是从py2拿过来的，需要改造。改造方法在后面</span>
<span style="color:#f92672">import</span> HTMLTestRunner
</code></pre></div><p>编写测试类：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestAlgor1</span>(unittest<span style="color:#f92672">.</span>TestCase):
    <span style="color:#a6e22e">@classmethod</span>
    <span style="color:#75715e"># 类前执行</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUpClass</span>(self):
        print(<span style="color:#e6db74">&#34;setUpClass&#34;</span>)
    <span style="color:#75715e"># 类后执行</span>
    <span style="color:#a6e22e">@classmethod</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tearDownClass</span>(self):
        print(<span style="color:#e6db74">&#34;tearDownClass&#34;</span>)
    <span style="color:#75715e"># 方法前执行</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
        print(<span style="color:#e6db74">&#34;setUp&#34;</span>)
    <span style="color:#75715e"># 方法后执行</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tearDown</span>(self):
        print(<span style="color:#e6db74">&#34;tearDown&#34;</span>)
    <span style="color:#75715e"># 测试方法，一般命名为测试某某某类</span>
    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testAdd1</span>(self):
        self<span style="color:#f92672">.</span>assertEquals(algor<span style="color:#f92672">.</span>add(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>), <span style="color:#ae81ff">4</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testAdd2</span>(self):
        self<span style="color:#f92672">.</span>assertEquals(algor<span style="color:#f92672">.</span>add(<span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">514</span>), <span style="color:#ae81ff">628</span>)
</code></pre></div><p>主函数：构建测试套件和生成报告：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Python3" data-lang="Python3"><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:
    suite <span style="color:#f92672">=</span> unittest<span style="color:#f92672">.</span>TestSuite()
    suite<span style="color:#f92672">.</span>addTest(TestAlgor1(<span style="color:#e6db74">&#34;testAdd1&#34;</span>))
    suite<span style="color:#f92672">.</span>addTest(TestAlgor1(<span style="color:#e6db74">&#34;testAdd2&#34;</span>))
    filename <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;./apptestresult.html&#39;</span>
    fb <span style="color:#f92672">=</span> open(filename, <span style="color:#e6db74">&#39;wb&#39;</span>)
    runner <span style="color:#f92672">=</span> HTMLTestRunner<span style="color:#f92672">.</span>HTMLTestRscaunner(stream<span style="color:#f92672">=</span>fb, title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;测试HTMLTestRunner&#34;</span>, description<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;测试HTMLTestRunner&#34;</span>)
    runner<span style="color:#f92672">.</span>run(suite)
    fb<span style="color:#f92672">.</span>close() 
</code></pre></div><p>上述方案是一个基于python2里面HTMLTestRunner模块的实现，需要先下载HTMLTestRunner.py文件然后进行改进以在py3环境中使用</p>
<p>第94行，将import StringIO修改成import io</p>
<p>第539行，将self.outputBuffer = StringIO.StringIO()修改成self.outputBuffer = io.StringIO()</p>
<p>第642行，将if not rmap.has_key(cls):修改成if not cls in rmap:</p>
<p>第766行，将uo = o.decode(&lsquo;latin-1&rsquo;)修改成uo = e</p>
<p>第772行，将ue = e.decode(&lsquo;latin-1&rsquo;)修改成ue = e</p>
<p>第631行，将print &raquo; sys.stderr, &lsquo;\nTime Elapsed: %s&rsquo; % (self.stopTime-self.startTime)修改成print(sys.stderr, &lsquo;\nTime Elapsed: %s&rsquo; % (self.stopTime-self.startTime))</p>
<p>其中，Python3中，已经没有StringIO了。取而代之的是io.StringIO。
<a href="https://www.cnblogs.com/huny/p/12078784.html">参见</a></p>
<p>在python3有第三方库可以实现相关功能，这个库是html-testRunner
注意import的大小写</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3"><span style="color:#f92672">import</span> HtmlTestRunner
</code></pre></div><p>主函数只要写</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3">unittest<span style="color:#f92672">.</span>main(testRunner<span style="color:#f92672">=</span>HtmlTestRunner<span style="color:#f92672">.</span>HTMLTestRunner(output<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;example_dir&#39;</span>))
</code></pre></div><p><a href="https://pypi.org/project/html-testRunner/#description">参见</a></p>

          </section>
      </p>
      
    </section>
    <footer class="post-meta">
        
            <img class="author-thumb" src="https://sonemiyuki.cn/images/user.png" alt="Author image" nopin="nopin" />
        
        
            miyuki
        
        on
            
                <a href="https://sonemiyuki.cn/tags/tester/">#tester</a>,
            
                <a href="https://sonemiyuki.cn/tags/python/">#Python</a>,
            
                <a href="https://sonemiyuki.cn/tags/unittest/">#unittest</a>,
            
        
        <time class="post-date" datetime="2021-05-06T10:54:24&#43;08:00">
            6 May 2021
        </time>
    </footer>
</article>

	

	<nav class="pagination" role="navigation">
	
	    <a class="newer-posts" href="https://sonemiyuki.cn/post/page/2/">&larr; Newer Posts</a>
	
	<span class="page-number">Page 3 of 3</span>
	
</nav>

</main>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">世界的中心</a> All rights reserved - 2021-</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="https://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/syui/hugo-theme-air">hugo-theme-air</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="https://sonemiyuki.cn/js/jquery.js"></script>
    <script type="text/javascript" src="https://sonemiyuki.cn/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://sonemiyuki.cn/js/index.js"></script>
    <script src="https://sonemiyuki.cn/js/particles.min.js"></script>
    <script src="https://sonemiyuki.cn/js/particles.js"></script>  

</body>
</html>

